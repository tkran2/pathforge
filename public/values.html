<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Values Profiler</title>
    <link rel="stylesheet" href="/static/style.css">
    <style>
        .choice-container { display: flex; justify-content: space-around; align-items: center; margin: 2em 0; }
        .choice-btn { width: 45%; height: 150px; font-size: 1.2em; }
        .profiler-nav { margin-bottom: 1em; padding-bottom: 1em; border-bottom: 1px solid #eee; }
        .profiler-nav a { margin-right: 1em; }
        .profiler-nav strong { color: black; }
    </style>
</head>
<body>
    <header class="main-header">
        <a href="/static/index.html" class="logo">PathForge</a>
        <nav>
            <a href="/static/assessment.html">Aptitude Tests</a>
            <a href="/static/dashboard.html">My Matches</a>
            <a href="/static/login.html">Logout</a>
        </nav>
    </header>
    <main>
        <h1>Profilers</h1>
        <div class="profiler-nav">
            <a href="/static/interests.html">Interests</a> | 
            <strong>Values</strong> | 
            <a href="/static/styles.html">Styles</a>
        </div>
        <p id="instructions">Which of these is more important to you in a job?</p>
        <div id="game-area">
            <div id="choice-container">
                <button id="btn-a" class="choice-btn"></button>
                <span style="font-size: 1.5em;">OR</span>
                <button id="btn-b" class="choice-btn"></button>
            </div>
        </div>
        <div id="results-container" style="display: none;" class="detail-card">
            <h2>Your Top Work Values</h2>
            <pre id="results-output"></pre>
        </div>
    </main>
    <script>
        // Full JavaScript for the Values Profiler is here
        document.addEventListener('DOMContentLoaded', function() {
            const currentUser = localStorage.getItem('pathforge_user') || 'guest';
            const values = [ "Achievement", "Independence", "Recognition", "Relationships", "Support", "Working Conditions" ];
            const pairs = [];
            for (let i = 0; i < values.length; i++) {
                for (let j = i + 1; j < values.length; j++) {
                    pairs.push([values[i], values[j]]);
                }
            }
            const shuffledPairs = pairs.sort(() => Math.random() - 0.5);
            let currentPairIndex = 0;
            const valueScores = { "Achievement": 0, "Independence": 0, "Recognition": 0, "Relationships": 0, "Support": 0, "Working Conditions": 0 };
            const instructionsEl = document.getElementById('instructions');
            const gameArea = document.getElementById('game-area');
            const btnA = document.getElementById('btn-a');
            const btnB = document.getElementById('btn-b');
            const resultsContainer = document.getElementById('results-container');
            const resultsOutput = document.getElementById('results-output');

            async function saveProfile(profile) {
                await fetch(`/save_values/${currentUser}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ values: profile })
                });
            }

            function showResults() {
                gameArea.style.display = 'none';
                instructionsEl.textContent = 'Your profile has been saved!';
                const sortedValues = Object.entries(valueScores).sort((a, b) => b[1] - a[1]);
                let resultText = "Your ranked work values:\n\n";
                sortedValues.forEach(([value, score], index) => {
                    resultText += `${index + 1}. ${value} (Chosen ${score} times)\n`;
                });
                resultsOutput.textContent = resultText;
                resultsContainer.style.display = 'block';
                saveProfile(valueScores);
            }

            function handleChoice(selectedValue) {
                valueScores[selectedValue]++;
                currentPairIndex++;
                loadNextPair();
            }

            function loadNextPair() {
                if (currentPairIndex >= shuffledPairs.length) {
                    showResults();
                    return;
                }
                const [valA, valB] = shuffledPairs[currentPairIndex];
                btnA.textContent = valA;
                btnB.textContent = valB;
                instructionsEl.textContent = `Question ${currentPairIndex + 1} of ${shuffledPairs.length}: Which is more important?`;
            }
            btnA.addEventListener('click', () => handleChoice(btnA.textContent));
            btnB.addEventListener('click', () => handleChoice(btnB.textContent));
            loadNextPair();
        });
    </script>
</body>
</html>
